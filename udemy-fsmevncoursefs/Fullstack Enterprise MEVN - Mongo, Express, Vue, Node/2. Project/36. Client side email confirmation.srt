1
00:00:00,270 --> 00:00:07,020
To be able to confront the user's email on the clan site we would expose a route that the user visits

2
00:00:07,020 --> 00:00:08,970
when they click on the activation link.

3
00:00:08,970 --> 00:00:14,970
We will get the two can make a POST request to the server attempts to confirm the User's Accounts and

4
00:00:14,970 --> 00:00:18,720
if everything is successful the user's account will be confirmed.

5
00:00:18,720 --> 00:00:24,480
So the first thing we're going to do is create a beach called email confirm this speech is not going

6
00:00:24,480 --> 00:00:26,130
to have much of a template.

7
00:00:26,130 --> 00:00:34,070
It's going to have an edge 1 the text center dot NY 16 and it's simply going to say confirming in the

8
00:00:34,670 --> 00:00:40,640
final script on exports default and object when this component is mounted.

9
00:00:40,650 --> 00:00:43,340
For now we are just going to console that law.

10
00:00:43,350 --> 00:00:47,170
This that our arms.

11
00:00:47,220 --> 00:00:53,540
Now we need to register a vote for this page on this world has to be exactly what we sent to the user

12
00:00:53,550 --> 00:00:55,530
window we're trying to activate the account.

13
00:00:55,710 --> 00:00:58,220
So this is post safe.

14
00:00:58,290 --> 00:00:58,880
And this is.

15
00:00:59,060 --> 00:01:00,780
And this is the email we send to the user.

16
00:01:00,810 --> 00:01:04,890
And this is the year oh so off slash emails slash confirm.

17
00:01:04,980 --> 00:01:07,280
And then the email confirmed code.

18
00:01:07,680 --> 00:01:16,500
So in our three vaults file the path is going to be off slash emails slash confirm and then would have

19
00:01:16,740 --> 00:01:26,050
dynamic took in and the components is going to be email confirm that's in Port email confirm.

20
00:01:26,110 --> 00:01:31,230
Now let's try to activate a user's account and see if the speech mounts correctly.

21
00:01:31,260 --> 00:01:33,900
I want to clean up my database so we start afresh.

22
00:01:33,900 --> 00:01:39,660
So I'm simply going to change my database environment vehicle and remember mortgage is automatically

23
00:01:39,660 --> 00:01:42,360
going to create this database if it doesn't exist.

24
00:01:42,360 --> 00:01:46,530
So now I'll visit my application try to register

25
00:01:50,910 --> 00:01:55,090
click on sign up or use all ready access.

26
00:01:55,100 --> 00:02:00,580
That's because if I change my involvement vehicle I have to stop the server and started to get.

27
00:02:00,590 --> 00:02:02,770
Don't forget that.

28
00:02:03,130 --> 00:02:07,090
Now let's try to register again on this demo.

29
00:02:07,100 --> 00:02:09,000
We see a confirmation message.

30
00:02:09,210 --> 00:02:14,470
Now let's see M. trop check my inbox and you can see the confirmation link.

31
00:02:14,520 --> 00:02:19,850
So if I visit this link you can see we have the text that sees confirming email.

32
00:02:19,920 --> 00:02:21,800
We probably want to design that better.

33
00:02:21,930 --> 00:02:23,860
So the text should be brown.

34
00:02:23,910 --> 00:02:24,480
Great.

35
00:02:24,480 --> 00:02:25,320
That looks better.

36
00:02:25,590 --> 00:02:30,720
Now what happens when this component is mounts that we are going to get this token.

37
00:02:30,750 --> 00:02:32,880
So remember we locked the poems.

38
00:02:33,120 --> 00:02:36,010
So if we check out the console we should see the bombs.

39
00:02:36,030 --> 00:02:43,260
So we have the token that we are going to make a post request to the server with this token and attempts

40
00:02:43,260 --> 00:02:45,330
to activate the user's account.

41
00:02:45,330 --> 00:02:49,060
So to make that post request we are going to require an action.

42
00:02:49,290 --> 00:02:58,320
Go to the store actions and we are going to spot a Constance call post confirm email and would find

43
00:02:58,320 --> 00:02:59,220
a method.

44
00:02:59,220 --> 00:03:05,860
This is going to make a post request to off slash emails slash confirm and it also received the data

45
00:03:06,240 --> 00:03:12,150
not IMO confirm that you will import this action and when the component is small on set we are going

46
00:03:12,150 --> 00:03:15,090
to dispatch it for the data.

47
00:03:15,110 --> 00:03:18,040
We are simply going to have the token which is this.

48
00:03:18,070 --> 00:03:21,070
Dots throughout the.

49
00:03:21,500 --> 00:03:22,590
Token.

50
00:03:22,620 --> 00:03:29,440
Now let's see what happens if we refreshed the speech and the component is mounted check out the network.

51
00:03:29,440 --> 00:03:34,740
This also for true to say token is not defined.

52
00:03:34,820 --> 00:03:41,030
That's what we receive from the server which means our media Web most likely has an error.

53
00:03:41,120 --> 00:03:42,430
So that's it.

54
00:03:42,710 --> 00:03:45,610
The email confirm and see what we have.

55
00:03:45,680 --> 00:03:52,160
So we have chicken right here and took these nodes you find because we have to do structure so from

56
00:03:52,370 --> 00:03:55,130
request the body if we have to use it.

57
00:03:55,400 --> 00:04:03,080
If we try this again refresh the speech and after the pages refresh you can see confirm a movie tends

58
00:04:03,080 --> 00:04:06,110
to us they use us fresh data.

59
00:04:06,300 --> 00:04:13,130
Will confront Cody's know the email confirmed ad is the timestamp at this moment and we have a fresh

60
00:04:13,130 --> 00:04:14,650
token for the user.

61
00:04:14,660 --> 00:04:22,760
What we want to do is make sure this data is set for authentication so in the email confirm we are going

62
00:04:22,760 --> 00:04:23,540
to have a dog.

63
00:04:23,570 --> 00:04:30,910
Then we'll get the response I will call this not set off.

64
00:04:31,110 --> 00:04:39,330
I will pass in response the data and if you don't remember if you check all the mix in the set of my

65
00:04:39,330 --> 00:04:44,330
thought takes the payload sets its low cost on each commits each of the store and redirects to use that

66
00:04:44,320 --> 00:04:45,540
to the homepage.

67
00:04:45,600 --> 00:04:49,680
So for us to try out this to see if it works fine.

68
00:04:49,770 --> 00:04:51,630
We need to activate a new account.

69
00:04:51,690 --> 00:04:54,760
But before that let's see the case where there is a filter.

70
00:04:55,110 --> 00:05:00,400
So if I refresh we have a filter to invalid confirmation code.

71
00:05:00,420 --> 00:05:07,740
What I'm going to do is I'm going to add a dot catch and we are going to see this that router the push

72
00:05:07,980 --> 00:05:09,390
to the homepage.

73
00:05:09,390 --> 00:05:16,260
In future we are going to be able to flash messages so we are going to see to do flash a message to

74
00:05:16,260 --> 00:05:22,170
the user but we don't yet have the flash functionality so we agreed to do that later.

75
00:05:22,170 --> 00:05:28,020
So if we come on refresh or try to confirm the user's account of confirmed these are just related to

76
00:05:28,020 --> 00:05:29,050
the homepage.

77
00:05:29,060 --> 00:05:32,980
That's that's what happens when the user confirms their account.

78
00:05:33,020 --> 00:05:35,490
Our logout and the register a new user

79
00:05:40,400 --> 00:05:43,060
so we have welcome Emily Meyers.

80
00:05:43,100 --> 00:05:51,320
So now if we check out our network or our application you can see that the user here is Emily Meyers

81
00:05:51,530 --> 00:05:54,650
and the email confirmed could e in the user's data.

82
00:05:54,650 --> 00:06:02,080
What we are going to do is we are going to click on confirm accounts and the use extradited to the homepage.

83
00:06:02,120 --> 00:06:08,720
Now if we check the network again or the application and check out the user's data you see the email

84
00:06:08,720 --> 00:06:13,340
confirmed code has been set too low and the email confirmed at it's a date.

85
00:06:13,960 --> 00:06:14,550
OK.

86
00:06:14,690 --> 00:06:17,450
So email activation works successfully.

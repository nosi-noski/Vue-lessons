1
00:00:00,360 --> 00:00:06,020
To have added security on resetting passwords when a user tries to reset their password we are going

2
00:00:06,030 --> 00:00:09,640
to make sure that the password link has not expired.

3
00:00:09,660 --> 00:00:15,000
So what we are going to do is make sure that the password link is no older than five minutes.

4
00:00:15,000 --> 00:00:16,120
And how do we do that.

5
00:00:16,140 --> 00:00:20,470
We are going to calculate the time in minutes.

6
00:00:21,150 --> 00:00:32,720
And first we will get today's dates that get time minus a new dates from the existing reset.

7
00:00:32,760 --> 00:00:40,620
That created at the get time and this is going to give us the time in milliseconds.

8
00:00:40,620 --> 00:00:48,150
And we are going to divide this time in milliseconds by 60 thousand to get the time in minutes.

9
00:00:48,150 --> 00:00:51,540
Then we are going to get the full number.

10
00:00:51,540 --> 00:00:57,990
So Mark dot seal is going to rounded up to the nearest whole number and give us the time in minutes.

11
00:00:57,990 --> 00:01:06,510
So we agreed to check if time in minutes is greater than five which means greater than five minutes.

12
00:01:06,510 --> 00:01:10,860
Then we are going to for a New York validation exception.

13
00:01:10,860 --> 00:01:18,920
So when you Yup I was seeing reset token expire.

14
00:01:20,120 --> 00:01:20,480
OK.

15
00:01:21,500 --> 00:01:25,580
And before actually doing this ever we are going to delete the password reset.

16
00:01:25,880 --> 00:01:32,920
So we are going to see a weak password reset not find one and delete.

17
00:01:33,350 --> 00:01:36,640
And we are going to use the token to delete it.

18
00:01:36,740 --> 00:01:41,990
So we'll find a password we said with this token and delete it then we are going to throw this exception

19
00:01:42,020 --> 00:01:47,750
that says request token or reset token expire to test this out.

20
00:01:47,780 --> 00:01:53,620
I sent myself a password we said link about five minutes ago before starting to record the tutorial.

21
00:01:53,750 --> 00:01:59,450
So I'm going to click on this link and try to reset my password if everything works fine.

22
00:01:59,450 --> 00:02:06,300
Then this password link must have expired by now and we can see resets you can expire.

23
00:02:06,650 --> 00:02:11,880
And if I try to click again we have invalid reset token because the password reset token has already

24
00:02:11,880 --> 00:02:12,780
been deleted.

25
00:02:13,230 --> 00:02:20,130
So I'm going to try to reset my password but this time I'll use a link that has not expired so I'll

26
00:02:20,130 --> 00:02:25,710
send a password resettling and then I'm going to click on that link.

27
00:02:28,080 --> 00:02:31,920
And try to reset my password and great.

28
00:02:31,980 --> 00:02:34,850
It works now syncs the link has not expired.

29
00:02:34,860 --> 00:02:35,220
All right.

30
00:02:35,310 --> 00:02:39,270
That's some really good added security for resetting users passwords.

31
00:02:39,270 --> 00:02:40,830
See you in the next lesson.

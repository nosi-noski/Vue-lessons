1
00:00:00,260 --> 00:00:07,920
Let us continue refactoring into registered here after the user successfully sign saying we set the

2
00:00:08,100 --> 00:00:10,320
users data to low cloud storage.

3
00:00:10,320 --> 00:00:16,320
We also commit the set off and we redirect the user to the home screen.

4
00:00:16,680 --> 00:00:23,640
We can actually handle this in a mixing since it's exactly the same thing we do for the logging.

5
00:00:23,670 --> 00:00:30,610
So what we agreed to do is we're going to create a new mixing called off to Jess and this is going to

6
00:00:30,610 --> 00:00:35,350
export default an object.

7
00:00:35,500 --> 00:00:42,840
We're going to have methods and the first method I want to have is a method called set off and this

8
00:00:42,840 --> 00:00:48,300
is going to set the users data to low cost on each and also comments set off.

9
00:00:48,300 --> 00:00:53,640
So I'll cut that out of this component and here I'll call set off

10
00:00:57,180 --> 00:01:02,780
this is going to take in a payload and will positive payload to Jason with the string.

11
00:01:02,790 --> 00:01:10,980
If I am also proceed to the commit method we also need to import set off in this mixing if we have to

12
00:01:10,980 --> 00:01:16,780
use it so import set of from actions.

13
00:01:16,980 --> 00:01:24,810
We probably also want to bring in the redirect so distilled water that push to the home screen.

14
00:01:25,480 --> 00:01:26,250
Okay.

15
00:01:26,500 --> 00:01:35,340
Now in the logging all we can do is remove this and remove all of the duplicate functionality so we

16
00:01:35,340 --> 00:01:41,870
don't even need to do this or we need to do is call set off and pass in response that data.

17
00:01:43,090 --> 00:01:45,550
And we do exactly the same thing in our register.

18
00:01:45,570 --> 00:01:55,170
So in our register I'm going to delete this all of this and simply call set off response not data.

19
00:01:55,190 --> 00:02:02,150
Now I'm going to make the auth mix in to be a global mixing because we are going to also have some computer

20
00:02:02,150 --> 00:02:05,390
properties like these authenticator in this mix.

21
00:02:05,900 --> 00:02:07,880
So I'm going to import this mixing

22
00:02:13,580 --> 00:02:21,890
from clients make sense of and use it view that mixing

23
00:02:25,890 --> 00:02:26,760
of mixing.

24
00:02:26,760 --> 00:02:32,880
Now let's try to use our authentication piece again to see the still work fine.

25
00:02:33,120 --> 00:02:34,200
I'll try to signing

26
00:02:43,520 --> 00:02:46,610
and signing works perfectly is to be directed.

27
00:02:46,880 --> 00:02:50,710
And we have reflected all that to the earth mixing.

28
00:02:50,810 --> 00:02:52,640
What else can we have in this mixing.

29
00:02:52,670 --> 00:02:57,980
We are going to have computer property on this.

30
00:02:57,980 --> 00:03:01,400
Property is going to help us get the authenticated user.

31
00:03:01,400 --> 00:03:02,900
So let's do this.

32
00:03:02,930 --> 00:03:03,800
We have user.

33
00:03:04,150 --> 00:03:14,270
And this is going to return this that store that states that are not user.

34
00:03:14,270 --> 00:03:17,890
And this is only going to work if the user is authenticated.

35
00:03:17,930 --> 00:03:18,200
Right.

36
00:03:18,650 --> 00:03:21,140
So how can we use this computer property.

37
00:03:21,230 --> 00:03:23,960
It's available everywhere in the application.

38
00:03:23,960 --> 00:03:30,180
So let's come to the home and try to do this use our DOT name.

39
00:03:30,620 --> 00:03:35,780
And if we receive the whole grade you can see men off and then backwards.

40
00:03:35,800 --> 00:03:38,020
Because this is the name of the authenticated user.

41
00:03:38,320 --> 00:03:39,810
That's really cool right.

42
00:03:40,030 --> 00:03:44,590
So our mixing can be used by any component and this is really useful.

43
00:03:44,590 --> 00:03:48,790
Why don't we have a mix in for checking if they use ice authenticated.

44
00:03:48,820 --> 00:03:58,330
We can have an off computer property and this is going to return this dot store that states that off

45
00:03:59,700 --> 00:04:03,420
that user and we wanted this to be a boolean.

46
00:04:03,930 --> 00:04:07,140
So it checks if the user is available in the store.

47
00:04:07,140 --> 00:04:10,720
And this is when you tell us if the user is authenticated or not.

48
00:04:11,010 --> 00:04:17,860
So in I mean we can check if the user's authenticated before displaying these two.

49
00:04:18,030 --> 00:04:27,800
So we can see if off and if we come back it doesn't seem like it's working correctly.

50
00:04:27,810 --> 00:04:29,680
Let's have a look.

51
00:04:29,730 --> 00:04:36,120
It should actually see the if not off because if the user is not authenticated then we want to see the

52
00:04:36,120 --> 00:04:38,190
signing on logging button.

53
00:04:38,310 --> 00:04:38,790
Great.

54
00:04:38,820 --> 00:04:40,210
So you can see those buttons.

55
00:04:40,280 --> 00:04:43,610
Gone away because at this moment to use eyes authenticate it.

56
00:04:44,190 --> 00:04:49,980
But we can also toggle that use us authentication states by removing this from local storage.

57
00:04:49,980 --> 00:04:54,820
Why don't we have a very cool method to do that in off makes in.

58
00:04:54,840 --> 00:05:05,460
We can have a method called on set off and what this is going to do is look our storage dot remove item

59
00:05:05,520 --> 00:05:16,740
called off and he's going to commit a mutation called on set off and this mutation is basically going

60
00:05:16,740 --> 00:05:20,320
to clear the users data from the Rudolph store.

61
00:05:20,610 --> 00:05:24,740
Then Walter that push to the home page.

62
00:05:24,960 --> 00:05:34,290
So I'm also going to import on set off and I'm going to make sure I define that in my store actions.

63
00:05:34,290 --> 00:05:39,490
So export Constance on set of course on set off.

64
00:05:39,570 --> 00:05:41,890
Now we need to handle this mutation.

65
00:05:42,000 --> 00:05:51,950
So we going to import on set off into the mutations file and define a mutation with that deadly we are

66
00:05:51,950 --> 00:05:59,330
not going to require any payload but we are going to set of use that should be law and state that token

67
00:06:00,140 --> 00:06:01,250
should be known.

68
00:06:01,790 --> 00:06:06,440
So now we can call the onset of method from anywhere in application.

69
00:06:06,500 --> 00:06:15,590
So if I come to the main or the view I can have a diff with a V else and I can have a span that sees

70
00:06:15,680 --> 00:06:21,270
logout and if I refresh grade you can see my logout button there.

71
00:06:21,290 --> 00:06:23,220
So let's give this a couple of classes.

72
00:06:23,330 --> 00:06:31,400
So the class is going to be cursor points are the text is going to be brown but the hover text is going

73
00:06:31,400 --> 00:06:40,970
to be brown darkest and a click is going to call on set off.

74
00:06:41,000 --> 00:06:48,360
So if I refresh and if I click on that great you can see that we are no longer authenticated.

75
00:06:48,400 --> 00:06:53,030
So now we have an error from the home that sees cannot before putting name of law.

76
00:06:53,050 --> 00:06:57,880
That's because we are displaying the name of a user even though the user is not authenticated.

77
00:06:57,880 --> 00:07:04,180
So you want to also make sure that in your home or wherever you're using the off users details you want

78
00:07:04,180 --> 00:07:07,290
to check if the user is authenticated before doing that.

79
00:07:07,300 --> 00:07:08,730
So this is all we can do.

80
00:07:08,830 --> 00:07:17,800
We can have an etch one that sees movement off and this is going to be the if not off and then we can

81
00:07:17,800 --> 00:07:28,100
have another etch one with the same classes that sees welcome use for that name.

82
00:07:28,610 --> 00:07:30,530
So this is going to be the else.

83
00:07:31,220 --> 00:07:34,370
So this is only displayed if the user is authenticated.

84
00:07:34,850 --> 00:07:37,730
So if I refresh great we do not see that.

85
00:07:38,090 --> 00:07:43,050
But if I sighting and click on signing we have.

86
00:07:43,040 --> 00:07:44,240
Welcome back.

87
00:07:44,430 --> 00:07:50,990
Coulda displayed but it looks like the novel bar wasn't reactive.

88
00:07:51,320 --> 00:07:52,710
Let's check this out.

89
00:07:52,730 --> 00:07:55,780
We have the main.

90
00:07:56,100 --> 00:08:07,110
And it says V if not authenticated then display this and the else displayed the logout.

91
00:08:07,210 --> 00:08:08,020
Great.

92
00:08:08,060 --> 00:08:09,550
We can see welcome.

93
00:08:09,590 --> 00:08:15,560
And the name of the authenticated user and enough but also automatically changed looks like everything

94
00:08:15,560 --> 00:08:16,490
works as expected.
